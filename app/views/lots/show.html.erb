<% set_meta_tags title: 'くじの結果' %>
<div class="container mx-auto px-4 py-10 max-w-lg">
  <p class="text-2xl font-bold mb-5">散歩くじの結果</p>

  <!-- Card -->
  <div class="card bg-base-100 shadow-xl mb-5">
    <!--Place photo-->
    <figure><%= image_tag "https://maps.googleapis.com/maps/api/place/photo?maxwidth=600&photo_reference=#{@lot.photo_url}&key=#{Rails.application.credentials.google_map_api_key}" %></figure>
    <div class="flex justify-end items-center p-1">
      <span class="text-xs font-light">Powered by</span>
      <%= image_tag 'google_on_white.png', size: '60x60' %>
    </div>
    <div class="card-body">
      <!--Destination-->
      <div class="flex items-center">
        <div class="toast toast-start toast-middle">
          <div class="alert alert-success">
            <div class="font-bold">
              <span>行先</span>
            </div>
          </div>
        </div> 
        <div class="mx-3">
          <h2 class="card-title"><%= @lot.destination_name %></h2>
          <div class="flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-map-pin" width="15" height="15" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <circle cx="12" cy="11" r="3"></circle>
              <path d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0z"></path>
            </svg>
            <p class="prose text-gray-400 text-sm"><%= @lot.destination_address %></p>
          </div>
        </div>
      </div>
      
      <!--Activity-->
      <div class="flex items-center">
        <div class="toast toast-start toast-middle">
          <div class="alert alert-warning">
            <div class="font-bold">
              <span>目的</span>
            </div>
          </div>
        </div>
        <h2 class="card-title mx-3">
          <%= @lot.activity.content %>
        </h2>
      </div>
      <div class="card-actions justify-end">
        <div class="badge badge-lg badge-outline"><%= @lot.location_type.name %></div>
      </div>
    </div>
  </div>

  <!-- GoogleMap -->
  <div
    data-controller="show-map"
    data-show-map-destinationlatitude-value="<%= @lot.destination_latitude %>"
    data-show-map-destinationlongitude-value="<%= @lot.destination_longitude %>"
    data-show-map-startpointlatitude-value="<%= @lot.start_point_latitude %>"
    data-show-map-startpointlongitude-value="<%= @lot.start_point_longitude %>"
    class="h-[400px]">
  </div>

  <!-- GoogleMapで開くボタン -->
  <p class="text-lg font-bold label">ルートを確認する</p>
  <div class="flex-shrink-0 mb-5">
    <%= link_to "https://www.google.com/maps/dir/?api=1&origin=#{@lot.start_point_latitude},#{@lot.start_point_longitude}&destination=#{@lot.destination_latitude},#{@lot.destination_longitude}&travelmode=walking", class: 'btn btn-info btn-block', target: '_blank', rel: 'noopener noreferrer' do %>
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 50 50"><path d="M9.835 37.67a51.38 51.38 0 0 1 4.007 5.91c1.022 1.938 1.448 3.252 2.195 5.587.458 1.29.872 1.675 1.762 1.675.97 0 1.41-.655 1.75-1.668.706-2.205 1.26-3.888 2.134-5.478 1.715-3.07 3.846-5.798 5.94-8.42.567-.742 4.232-5.065 5.882-8.476 0 0 2.028-3.747 2.028-8.98 0-4.895-2-8.29-2-8.29l-5.758 1.542-3.497 9.21-.865 1.27-.173.23-.23.288-.404.46-.577.577-3.114 2.537-7.785 4.495z" fill="#34a853" />
        <path d="M1.8 26.17c1.9 4.34 5.564 8.155 8.043 11.503L23.01 22.076s-1.855 2.426-5.22 2.426c-3.748 0-6.776-2.993-6.776-6.767 0-2.588 1.557-4.366 1.557-4.366l-8.938 2.395z" fill="#fbbc04" />
        <path d="M23.157.792c4.373 1.41 8.116 4.37 10.38 8.735l-10.523 12.54s1.557-1.81 1.557-4.382c0-3.862-3.252-6.747-6.765-6.747-3.322 0-5.23 2.422-5.23 2.422v-7.9z" fill="#4285f4" />
        <path d="M4.212 6.333C6.824 3.208 11.42-.01 17.756-.01c3.074 0 5.39.807 5.39.807l-10.58 12.57H5.07z" fill="#1a73e8" />
        <path d="M1.8 26.17S.052 22.747.052 17.788c0-4.687 1.822-8.784 4.16-11.455l8.36 7.035z" fill="#ea4335" /><g fill="#767676">
      </svg>
      <span class="normal-case">GoogleMapでひらく</span>
    <% end %>
  </div>

  <!-- SNSシェアボタン -->
  <p class="text-lg font-bold label">SNSでシェアする</p>
  <div class="flex flex-row mb-3 mx-1">
    <div class="basis-1/2">
      <% twitter_share_url = "https://twitter.com/intent/tweet?text=#{@lot.destination_name}で%E3%80%8C#{@lot.activity.content}%E3%80%8Dにチャレンジします!!%0D%0A&hashtags=散歩くじ,散歩,ウォーキング,散歩好きな人と繋がりたい&url=https://www.walking-lot.com/lots/#{@lot.id}%0D%0A" %>
      <%= link_to twitter_share_url, class: 'btn bg-twitter btn-block border-twitter', target: '_blank', rel: 'noopener noreferrer' do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="fill-current mr-1">
          <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" fill="#ffffff"></path>
        </svg>
        <span class="normal-case" style="color: white;">Twitter</span>
      <% end %>
    </div>

    <div class="basis-1/2 mb-3 mx-1">
      <%= link_to "https://social-plugins.line.me/lineit/share?url=https://www.walking-lot.com/lots/#{@lot.id}", class: 'btn bg-line btn-block border-line', target: '_blank', rel: 'noopener noreferrer' do %>
        <%= image_tag 'line_icon', size: '40x40' %>
        <span style="color: white;">LINE</span>
      <% end %>
    </div>
  </div>

  <hr>
  <!-- ここに寄り道スポットを載せる -->

  <!-- 再度くじを引く -->
  <p class="text-lg font-bold label">別の場所に散歩する</p></p>
  <div class="pb-12">
    <%= link_to new_lot_path, class: 'btn btn-primary btn-block' do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-shoe" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M4 6h5.426a1 1 0 0 1 .863 .496l1.064 1.823a3 3 0 0 0 1.896 1.407l4.677 1.114a4 4 0 0 1 3.074 3.89v2.27a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10a1 1 0 0 1 1 -1z"></path>
        <path d="M14 13l1 -2"></path>
        <path d="M8 18v-1a4 4 0 0 0 -4 -4h-1"></path>
        <path d="M10 12l1.5 -3"></path>
      </svg>
      <span>もう一度くじを引く</span>
    <% end %>
  </div>
</div>
